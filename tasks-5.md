# –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è: ML Base

- [–ó–∞–¥–∞–Ω–∏–µ 1. –ü–æ–Ω–∏ —Ç–æ–∂–µ –∫–æ–Ω–∏](#–∑–∞–¥–∞–Ω–∏–µ-1-–ø–æ–Ω–∏-—Ç–æ–∂–µ-–∫–æ–Ω–∏)
- [–ó–∞–¥–∞–Ω–∏–µ 2. –†—É—á–Ω–æ–π —Å—á—ë—Ç ROC_AUC](#–∑–∞–¥–∞–Ω–∏–µ-2-—Ä—É—á–Ω–æ–π-—Å—á—ë—Ç-roc_auc)
- [–ó–∞–¥–∞–Ω–∏–µ 3. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç](#–∑–∞–¥–∞–Ω–∏–µ-3-–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π-—Ç–µ—Å—Ç)

## –ó–∞–¥–∞–Ω–∏–µ 1. –ü–æ–Ω–∏ —Ç–æ–∂–µ –∫–æ–Ω–∏

**–í–∞—Å –ø—Ä–æ—Å—è—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–¥–µ–ª—å, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—â—É—é –ª–æ—à–∞–¥–æ–∫ –∏ –ø–æ–Ω–∏. –í–º–µ—Å—Ç–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—ã –Ω–∞—à–ª–∏ –Ω–∞ GitHub –¥–≤–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –ø–æ—Å–ª–µ –ø—Ä–æ–≥–æ–Ω–∞ –Ω–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ–¥–Ω–∞ –∏–∑ –Ω–∏—Ö –ø–æ–∫–∞–∑–∞–ª–∞ ROC-AUC=0.7, –∞ –¥—Ä—É–≥–∞—è ROC-AUC=0.1. –ö–∞–∫—É—é –º–æ–¥–µ–ª—å –≤—ã –≤–æ–∑—å–º–µ—Ç–µ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã –∏ —á—Ç–æ –±—É–¥–µ—Ç–µ —Å –Ω–µ–π –¥–µ–ª–∞—Ç—å?**

> –û—Ç–≤–µ—Ç –Ω–∞–ø–∏—Å–∞—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π, –Ω–æ –∫—Ä–∞—Ç–∫–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä: "–ø–µ—Ä–≤—É—é, –æ—Ç–Ω–∏–º—É –æ—Ç –º–µ—Ç—Ä–∏–∫–∏ 0.1 –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏"

**–û—Ç–≤–µ—Ç:** –Ø –≤–æ–∑—å–º—É –º–æ–¥–µ–ª—å —Å ROC-AUC = 0.1 –∏ –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É—é –µ—ë –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–ø–æ–º–µ–Ω—è—é –∫–ª–∞—Å—Å—ã –º–µ—Å—Ç–∞–º–∏). –ú–µ—Ç—Ä–∏–∫–∞ ROC-AUC –±–ª–∏–∑–∫–∞ –∫ 0 ‚Äî –∑–Ω–∞—á–∏—Ç, –º–æ–¥–µ–ª—å –Ω–µ —Å–ª—É—á–∞–π–Ω–æ –æ—à–∏–±–∞–µ—Ç—Å—è, –∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–æ–±–æ—Ä–æ—Ç. –ü–æ—Å–ª–µ –∏–Ω–≤–µ—Ä—Å–∏–∏ –µ—ë –∫–∞—á–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω–µ—Ç —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–º ROC-AUC = 0.9.

---

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ

ROC-AUC ‚Äî —ç—Ç–æ –º–µ—Ç—Ä–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å —É–º–µ–µ—Ç **—Ä–∞–∑–¥–µ–ª—è—Ç—å –¥–≤–∞ –∫–ª–∞—Å—Å–∞**: –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ ‚Äî –ª–æ—à–∞–¥–µ–π –∏ –ø–æ–Ω–∏.

- –ï—Å–ª–∏ AUC = 0.5 ‚Äî –º–æ–¥–µ–ª—å —É–≥–∞–¥—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ.
- –ï—Å–ª–∏ AUC > 0.5 ‚Äî —á–µ–º –≤—ã—à–µ, —Ç–µ–º –ª—É—á—à–µ (–∏–¥–µ–∞–ª ‚Äî 1.0).
- –ï—Å–ª–∏ AUC < 0.5 ‚Äî –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö—É–∂–µ —Å–ª—É—á–∞–π–Ω–æ–π, –Ω–æ **—Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—à–∏–±–∞–µ—Ç—Å—è**.

üîπ –ê –≤–æ—Ç —ç—Ç–æ ‚Äî —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ.

–ú–æ–¥–µ–ª—å —Å AUC = 0.1 ‚Äî —ç—Ç–æ –Ω–µ "—Å–ª—É—á–∞–π–Ω—ã–π —à—É–º", –∞ **–ø–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω—ã–π –∞–Ω—Ç–∏-—ç–∫—Å–ø–µ—Ä—Ç**: –æ–Ω–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç –∫–∞–∂–¥—É—é –ª–æ—à–∞–¥—å –∫ –ø–æ–Ω–∏, –∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–Ω–∏ ‚Äî –∫ –ª–æ—à–∞–¥–∏.

–ù–æ –µ—Å–ª–∏ –º—ã **–ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ–Ω—è–µ–º –µ—ë –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–µ—Å—Ç–∞–º–∏** ‚Äî —Å–∫–∞–∂–µ–º, –≥–¥–µ –æ–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç "–ª–æ—à–∞–¥—å", –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å "–ø–æ–Ω–∏", –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç, ‚Äî —Ç–æ –ø–æ–ª—É—á–∏–º –º–æ–¥–µ–ª—å —Å –∫–∞—á–µ—Å—Ç–≤–æ–º, –±–ª–∏–∑–∫–∏–º –∫ AUC = 0.9.

üëâ –≠—Ç–æ **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ**, —á–µ–º –º–æ–¥–µ–ª—å —Å –∏—Å—Ö–æ–¥–Ω—ã–º AUC = 0.7.

### –ß—Ç–æ —è —Å–¥–µ–ª–∞—é

1. –í—ã–±–µ—Ä—É –º–æ–¥–µ–ª—å —Å AUC = 0.1
2. –ò–Ω–≤–µ—Ä—Ç–∏—Ä—É—é –µ—ë –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–∏–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏: –≤–º–µ—Å—Ç–æ 80% "–ª–æ—à–∞–¥—å" ‚Äî –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å 80% "–ø–æ–Ω–∏")
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É—é –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è

### –ü–æ—á–µ–º—É –Ω–µ –≤–∑—è—Ç—å —Ç—É, —á—Ç–æ —Å 0.7?

–ü–æ—Ç–æ–º—É —á—Ç–æ 0.9 > 0.7.  
–ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å **–±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –º–æ–¥–µ–ª—å**, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É–≤ –µ—ë –ª–æ–≥–∏–∫—É ‚Äî –≥–ª—É–ø–æ —ç—Ç–∏–º –Ω–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è.

---

## –ó–∞–¥–∞–Ω–∏–µ 2. –†—É—á–Ω–æ–π —Å—á—ë—Ç ROC_AUC

**–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã–¥–∞–ª —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–∞ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–ª–∞—Å—Å—É "1":**

| –ò—Å—Ç–∏–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –∫–ª–∞—Å—Å–∞ | –ü–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (0.6) | –û—Ü–µ–Ω–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ |
|-----------------------|---------------------------|--------------------|
| 1                     | 1                         | 0.95               |
| 0                     | 1                         | 0.9                |
| 1                     | 1                         | 0.85               |
| 0                     | 1                         | 0.8                |
| 1                     | 1                         | 0.75               |
| 1                     | 1                         | 0.7                |
| 1                     | 1                         | 0.65               |
| 1                     | 1                         | 0.6                |
| 0                     | 0                         | 0.55               |
| 0                     | 0                         | 0.5                |
| 0                     | 0                         | 0.45               |
| 1                     | 0                         | 0.4                |
| 0                     | 0                         | 0.35               |
| 0                     | 0                         | 0.3                |
| 0                     | 0                         | 0.25               |

**–ù–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –º–µ—Ç—Ä–∏–∫—É ROC_AUC. –¢–µ–∑–∏—Å–Ω–æ –æ–ø–∏—à–∏—Ç–µ —Ö–æ–¥ —Ä–µ—à–µ–Ω–∏—è.**

> –û—Ç–≤–µ—Ç –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ —Å–æ—Ç—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä: 4,12

**–û—Ç–≤–µ—Ç:** –ü—Ä–∏–º–µ–Ω–∏–º –º–µ—Ç–æ–¥ –ø–æ–¥—Å—á—ë—Ç–∞ AUC —á–µ—Ä–µ–∑ –ø–∞—Ä—ã.

–í—ã–ø–∏—à–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏ –∏—Ö —Å–∫–æ—Ä—ã (–æ—Ü–µ–Ω–∫–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, y_score):\
pos = [0.95, 0.85, 0.75, 0.7, 0.65, 0.6, 0.4], P = len(pos) = 7

–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ:\
neg = [0.9, 0.8, 0.55, 0.5, 0.45, 0.35, 0.3, 0.25], N = len(neg) = 8

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ pos –ø–æ—Å—á–∏—Ç–∞–µ–º, –∫–∞–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ neg –æ–Ω –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç:

| pos  | count(>neg) |
|------|-------------|
| 0.95 | 8 |
| 0.85 | 7 |
| 0.75 | 6 |
| 0.7  | 6 |
| 0.65 | 6 |
| 0.6  | 6 |
| 0.4  | 3 |

–ü—Ä–æ—Å—É–º–º–∏—Ä—É–µ–º: 8 + 7 + 6 + 6 + 6 + 6 + 3 = 42
–í—Å–µ–≥–æ –ø–∞—Ä: P * N = 7 * 8 = 56
–¢–æ–≥–¥–∞ AUC = 42/56 = 0,75

---

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ

ROC-AUC –º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –≤—Ä—É—á–Ω—É—é, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ **–ø–æ–¥—Å—á—ë—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ø–∞—Ä**:

> –≠—Ç–æ –¥–æ–ª—è –ø–∞—Ä (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç), –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –ø–æ–ª—É—á–∏–ª **–±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –æ—Ü–µ–Ω–∫—É**, —á–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π.

–ß–µ–º –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî —Ç–µ–º –ª—É—á—à–µ –º–æ–¥–µ–ª—å —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∫–ª–∞—Å—Å—ã.

#### –®–∞–≥ 1: –°–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞?

- –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (–º–µ—Ç–∫–∞ = 1):  
  —Å—Ç—Ä–æ–∫–∏: 1, 3, 5, 6, 7, 8, 12 ‚Üí –≤—Å–µ–≥–æ **7**
- –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ (–º–µ—Ç–∫–∞ = 0):  
  –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Üí **8**

–û–±—â–µ–µ —á–∏—Å–ª–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø–∞—Ä (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π + –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π):  
`7 √ó 8 = 56`

#### –®–∞–≥ 2: –û—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–µ–π

- –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (`pos`):  
  `[0.95, 0.85, 0.75, 0.7, 0.65, 0.6, 0.4]`
- –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ (`neg`):  
  `[0.9, 0.8, 0.55, 0.5, 0.45, 0.35, 0.3, 0.25]`

#### –®–∞–≥ 3: –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ ‚Äî —Å–∫–æ–ª—å–∫–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –æ–Ω "–æ–±–≥–æ–Ω—è–µ—Ç"?

–¢–æ –µ—Å—Ç—å: —Å–∫–æ–ª—å–∫–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏–º–µ—é—Ç **–º–µ–Ω—å—à—É—é –æ—Ü–µ–Ω–∫—É**, —á–µ–º —ç—Ç–æ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π.

| –û—Ü–µ–Ω–∫–∞ (pos) | –°–∫–æ–ª—å–∫–æ neg < pos | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|--------------|--------------------|------------|
| 0.95         | –≤—Å–µ 8              | 8          |
| 0.85         | –∫—Ä–æ–º–µ 0.9 ‚Üí 7      | 7          |
| 0.75         | –∫—Ä–æ–º–µ 0.9 –∏ 0.8 ‚Üí 6 | 6         |
| 0.7          | —Ç–µ –∂–µ ‚Üí 6          | 6          |
| 0.65         | —Ç–µ –∂–µ ‚Üí 6          | 6          |
| 0.6          | —Ç–µ –∂–µ ‚Üí 6          | 6          |
| 0.4          | —Ç–æ–ª—å–∫–æ 0.35, 0.3, 0.25 ‚Üí 3 | 3   |

–°—É–º–º–∏—Ä—É–µ–º:  
`8 + 7 + 6 + 6 + 6 + 6 + 3 = 42`

#### –®–∞–≥ 4: –°—á–∏—Ç–∞–µ–º ROC-AUC

–î–µ–ª–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ø–∞—Ä –Ω–∞ –æ–±—â–µ–µ —á–∏—Å–ª–æ –ø–∞—Ä:

```
42 / 56 = 0.75
```

---
